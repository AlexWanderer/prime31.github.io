
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Simple Value Mapping - prime[31] blog - Unity tips, tricks and random thoughts</title>
  <meta name="author" content="Mike Desaro">

  
  <meta name="description" content="This post is a quick one that covers a technique that I use all over the place: mapping a value from one range to a completely different range. Uses &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://blog.prime31.com/simple-value-mapping">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/atom.xml" rel="alternate" title="prime[31] blog - Unity tips, tricks and random thoughts" type="application/atom+xml">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="./javascripts/libs/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="//fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="//fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  

</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/">prime[31] blog - Unity tips, tricks and random thoughts</a></h1>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="https://www.google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:blog.prime31.com" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div>
<article class="hentry" role="article">
  
  <header>
    
      <h1 class="entry-title">Simple Value Mapping</h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2015-01-16T11:53:46-08:00'><span class='date'><span class='date-month'>Jan</span> <span class='date-day'>16</span><span class='date-suffix'>th</span>, <span class='date-year'>2015</span></span> <span class='time'>11:53 am</span></time>
        
      </p>
    
  </header>


<div class="entry-content"><p>This post is a quick one that covers a technique that I use all over the place: mapping a value from one range to a completely different range. Uses include everything from a simple health bar to mesh deformation to UI layout to shader vertex mods and tons more.</p>

<!-- more -->


<p>Lets say you want to show health bars for all the enemies or players in your game. The health of each varies from 10 for weaker enemies up to 200 for bosses. Whenever the health changes you want to update the health bar in the UI. This is where value mapping comes in handy. Most UI elements (and many other value-based scenarios) map from 0 to 1. The max health of your entities varies so you need a simple way to map that back to the 0 to 1 range.</p>

<h2>Mapping Health Value to UI Value</h2>

<p><img src="/images/posts/valueMapping/health-map.png" alt="" /></p>

<p>Mapping to the 0 to 1 range is pretty simple. The map01 method below shows how to do it. For the case presented in the screenshot the entity health is approximately 70. Running that through the <code>map01</code> method (code is below) like so <code>map01( 70f, 0f, 250f )</code> results in a value of 0.28f.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='csharp'><span class='line'><span class="c1">// Maps a value from some arbitrary range to the 0 to 1 range</span>
</span><span class='line'><span class="k">public</span> <span class="k">static</span> <span class="kt">float</span> <span class="nf">map01</span><span class="p">(</span> <span class="kt">float</span> <span class="k">value</span><span class="p">,</span> <span class="kt">float</span> <span class="n">min</span><span class="p">,</span> <span class="kt">float</span> <span class="n">max</span> <span class="p">)</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'>  <span class="k">return</span> <span class="p">(</span> <span class="k">value</span> <span class="p">-</span> <span class="n">min</span> <span class="p">)</span> <span class="p">*</span> <span class="m">1f</span> <span class="p">/</span> <span class="p">(</span> <span class="n">max</span> <span class="p">-</span> <span class="n">min</span> <span class="p">);</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>The <code>map01</code> method is just a reduction of a full value mapping method. The <code>map</code> method below allows you to not only map to the 0 to 1 range but expands the idea to allow mapping to any arbitrary range.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='csharp'><span class='line'><span class="c1">// Maps a value from ome arbitrary range to another arbitrary range</span>
</span><span class='line'><span class="k">public</span> <span class="k">static</span> <span class="kt">float</span> <span class="nf">map</span><span class="p">(</span> <span class="kt">float</span> <span class="k">value</span><span class="p">,</span> <span class="kt">float</span> <span class="n">leftMin</span><span class="p">,</span> <span class="kt">float</span> <span class="n">leftMax</span><span class="p">,</span> <span class="kt">float</span> <span class="n">rightMin</span><span class="p">,</span> <span class="kt">float</span> <span class="n">rightMax</span> <span class="p">)</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'>  <span class="k">return</span> <span class="n">rightMin</span> <span class="p">+</span> <span class="p">(</span> <span class="k">value</span> <span class="p">-</span> <span class="n">leftMin</span> <span class="p">)</span> <span class="p">*</span> <span class="p">(</span> <span class="n">rightMax</span> <span class="p">-</span> <span class="n">rightMin</span> <span class="p">)</span> <span class="p">/</span> <span class="p">(</span> <span class="n">leftMax</span> <span class="p">-</span> <span class="n">leftMin</span> <span class="p">);</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>With the ability to map from one range to any other range you can start to do some interesting things. If you read the <a href="/grass2d/">Interactive 2D Foliage post</a>, you may have noticed it actually used the <code>map</code> method to handle bending the foliage. In this particular use case we want to know how far our player moved into a trigger collider and then map that to a range of -1 to 1. We use the mapped -1 to 1 value to decide how far we will bend the foliage verts. Here is the relevant code snippet:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class='csharp'><span class='line'><span class="c1">// figure out how far we have moved into the trigger and then map the offset to -1 to 1.</span>
</span><span class='line'><span class="c1">// 0 would be neutral, -1 to the left and +1 to the right.</span>
</span><span class='line'><span class="kt">var</span> <span class="n">offset</span> <span class="p">=</span> <span class="n">col</span><span class="p">.</span><span class="n">transform</span><span class="p">.</span><span class="n">position</span><span class="p">.</span><span class="n">x</span> <span class="p">-</span> <span class="n">transform</span><span class="p">.</span><span class="n">position</span><span class="p">.</span><span class="n">x</span><span class="p">;</span>
</span><span class='line'><span class="kt">var</span> <span class="n">radius</span> <span class="p">=</span> <span class="n">_colliderHalfWidth</span> <span class="p">+</span> <span class="n">col</span><span class="p">.</span><span class="n">bounds</span><span class="p">.</span><span class="n">size</span><span class="p">.</span><span class="n">x</span> <span class="p">*</span> <span class="m">0.5f</span><span class="p">;</span>
</span><span class='line'><span class="kt">var</span> <span class="n">mappedOffset</span> <span class="p">=</span> <span class="n">map</span><span class="p">(</span> <span class="n">offset</span><span class="p">,</span> <span class="p">-</span><span class="n">radius</span><span class="p">,</span> <span class="n">radius</span><span class="p">,</span> <span class="p">-</span><span class="m">1f</span><span class="p">,</span> <span class="m">1f</span> <span class="p">);</span>
</span><span class='line'><span class="n">setVertHorizontalOffset</span><span class="p">(</span> <span class="n">mappedOffset</span> <span class="p">);</span>
</span></code></pre></td></tr></table></div></figure>

</div>


  <footer>
    <p class="meta">
      
  

<span class="byline author vcard">Posted by <span class="fn">Mike Desaro</span></span>

      




<time class='entry-date' datetime='2015-01-16T11:53:46-08:00'><span class='date'><span class='date-month'>Jan</span> <span class='date-day'>16</span><span class='date-suffix'>th</span>, <span class='date-year'>2015</span></span> <span class='time'>11:53 am</span></time>
      


    </p>
    
      <div class="sharing">
  
  
  
</div>

    
    <p class="meta">
      
        <a class="basic-alignment left" href="/recyclerkit" title="Previous Post: Garbage Collection and How to Avoid It">&laquo; Garbage Collection and How to Avoid It</a>
      
      
        <a class="basic-alignment right" href="/persisting-data-with-json" title="Next Post: Persisting Strongly Typed Data With JSON">Persisting Strongly Typed Data With JSON &raquo;</a>
      
    </p>
  </footer>
</article>

</div>

<aside class="sidebar">
  
    
  
</aside>


    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2015 - Mike Desaro -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  











</body>
</html>
